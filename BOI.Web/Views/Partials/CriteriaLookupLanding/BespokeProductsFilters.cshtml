@inherits UmbracoViewPage<CriteriaLookupResultsViewModel>

<div class="tab-content rich-text" @(Model.isBespoke ? "data-tab-active" : "") data-tab-title="Bespoke Criteria" id="BespokeCriteria" data-isbespoke="true">
    @Model.BespokeCategorySubText
    <form action="" class="product-filters criteria-filters" data-autocompleteurl="@Url.RouteUrl(CustomRouteNames.AutoCompleteCriteriaLookupBespokeAjax, new {controller = "CustomRouteAction", action = "AutoCompleteCriteriaLookup"})" data-ajaxaddurl="@Url.RouteUrl(CustomRouteNames.CriteriaLookupAjaxBespoke, new {controller = "CustomRouteAction", action = "FindBespokeCriteria"})" data-pageid="@Model.Id">
        <fieldset>
            <legend class="product-filters__title js-toggle-product-filters">
                <span>Filter Criteria</span>
                <div class="product-filters__title-icon">
                    <svg class="[ icon icon-cross-alt ]" aria-hidden="true">
                        <use xlink:href="#sprite-icon-cross-alt"></use>
                    </svg>
                    <svg class="[ icon icon-filter ]" aria-hidden="true">
                        <use xlink:href="#sprite-icon-filter"></use>
                    </svg>
                </div>
            </legend>

            <div class="product-filters-inner js-product-filters">

                <div class="product-filters-input-wrap -select-wrap -flex-grow-1">
                    <label for="BespokeCriteriaCategory">@Model.BespokeSearchCategoryText</label>
                    @Html.DropDownListFor(m => Model.BespokeCriteriaCategory, Model.BespokeCategoryList, new { id = "BespokeCriteriaCategory" })
                </div>

                <div class="product-filters-input-wrap -search-term">
                    <label for="BespokeCriteriaName">@Model.BespokeSearchNameText</label>
                    @Html.TextBoxFor(m => Model.BespokeCriteriaName, new { id = "BespokeCriteriaName", placeholder = "Enter your search" })
                </div>

                <div class="product-filters-input-wrap product-filters-input-wrap--update-button">
                    <button class="button" id="BespokeSearch" data-ajaxurl="@Url.RouteUrl(CustomRouteNames.CriteriaLookupAjaxBespoke, new { controller = "CustomRouteAction", action = "FindBespokeCriteria" })" data-pageid="@Model.Id"><span>Search</span></button>
                </div>

                <div class="product-filters-input-wrap -margin-right-0">
                    <button class="button button--secondary js-form-clear" id="BespokeClear" data-ajaxurl="@Url.RouteUrl(CustomRouteNames.CriteriaLookupAjaxBespoke, new { controller = "CustomRouteAction", action = "FindBespokeCriteria" })" data-pageid="@Model.Id"><span>Clear</span></button>
                </div>

                <input type="text" value="@Model.isBespoke" hidden />

                @if (Model.BespokePopularSearches != null && Model.BespokePopularSearches.Any())
                {
                    <div class="product-filters-popular-searches">
                        <label>Popular searches</label>
                        @foreach (var search in Model.BespokePopularSearches.OfType<Criteria>())
                        {
                            var criteriaName = search.CriteriaName.IsNullOrWhiteSpace() ? search.Name : search.CriteriaName;

                            <button id="searchBespokeCriteriaOnly" class="js-popular-criterea-search" data-search-term="@search.Name" data-ajaxaddurl="@Url.RouteUrl(CustomRouteNames.CriteriaLookupAjaxBespoke, new { controller = "CustomRouteAction", action = "FindBespokeCriteria" })" data-pageid="@Model.Id">
                                <span>
                                    @criteriaName
                                </span>
                            </button>
                        }
                    </div>
                }
            </div>
        </fieldset>
    </form>

    <partial name="~/Views/Partials/CriteriaLookupLanding/BespokeProducts.cshtml" />
</div>

